{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["\n\n\nimport axios from 'axios';\n\nexport async function getImageBySearch({ searchInput, page, perPage }) {\n    return (\n        await axios.get('https://pixabay.com/api/', {\n            params: {\n                key: '45240196-18d84f3cf70a1bfd2b8ad66bc',\n                q: searchInput,\n                page: page,\n                per_page: perPage,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n            }\n        })\n    ).data\n}\n","\n\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst gallery = document.querySelector('.gallery');\nconst galleryContainer = new SimpleLightbox('.gallery-item a', { \n    className: 'js-lightbox',\n    overlayOpacity: 0.8,\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n \n\nexport const createGallery = (data) => {\n    const markup = data\n        .map(\n            ({\n                webformatURL,\n                largeImageURL,\n                tags,\n                likes,\n                views,\n                comments,\n                downloads,\n            }) =>\n`<li class=\"gallery-item\">\n\t<a class=\"gallery-link\" href=\"${largeImageURL}\">\n\t\t<img\n\t\t\tclass=\"gallery-image\"\n\t\t\tsrc=\"${webformatURL}\"\n\t\t\talt=\"${tags}\"\n\t\t\t/>\n        <div class=\"stats\">\n            <h3 class=\"stats-title\">Likes\n             <p class=\"stats-value\">${likes}</p>\n             </h3>\n            <h3 class=\"stats-title\">Views\n             <p class=\"stats-value\">${views}</p>\n             </h3>\n            <h3 class=\"stats-title\">Comments\n             <p class=\"stats-value\">${comments}</p>\n             </h3>\n            <h3 class=\"stats-title\">Downloads\n             <p class=\"stats-value\">${downloads}</p>\n             </h3>\n        </div>\n\t</a>\n</li>`\n    ).join('')\n    gallery.insertAdjacentHTML('beforeend', markup);\n    galleryContainer.refresh()\n}","\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImageBySearch } from './js/pixabay-api'\nimport { createGallery } from './js/render-functions'\n\n\nconst refs = {\n    loader: document.querySelector('.loader'),\n    searchInput: document.querySelector('.search-form'),\n    loadMore: document.querySelector('.load-btn'),\n    gallery: document.querySelector('.gallery'),\n};\n\nrefs.searchInput.addEventListener('submit', addImageBySearch)\n\nconst params = {\n    searchInput: '',\n    page: 1,\n    perPage: 15,\n    totalPages: 0,\n}\n\n\n\n\n\nasync function addImageBySearch(event) {\n    event.preventDefault();\n    refs.gallery.innerHTML = '';\n    params.page = 1;\n    refs.loader.classList.add('hidden');\n    refs.loadMore.classList.add('is-hidden')\n    \n    params.searchInput = event.target.elements.search.value.trim();\n    if (params.searchInput === \"\") {\n        iziToast.error({\n            message:\n                'Please entry the search!',\n            position: 'topRight',\n            timeout: 2000,\n            icon: '',\n        });\n        event.currentTarget.reset();\n        return\n    }\n\n\n    try {\n      const totalResults = await getImageBySearch(params);\n      \n      if (totalResults.hits.length === 0) {\n        iziToast.error({\n            message:\n                `Sorry, there are no images matching your search query. Please try again!`,\n            position: 'topRight',\n            timeout: 2000,\n            icon: '',\n        })\n      }\n\n      params.totalPages = Math.ceil(totalResults.totalHits / params.perPage);\n      createGallery(totalResults.hits);\n      \n        if (params.totalPages > 1) {\n            refs.loadMore.classList.remove('is-hidden')\n            refs.loadMore.addEventListener(\"click\", handleLoadMore)\n        } else {\n            refs.loadMore.classList.add('is-hidden')\n        }   \n    }\n\n    catch(error) {\n        iziToast.error({\n            message:\n                `An error has occurred: ${error}`,\n            position: 'topRight',\n            timeout: 2000,\n            icon: '',\n        });\n    }\n\n    finally {\n            event.target.reset();\n            refs.loader.classList.add('hidden');\n    }\n}\n\n\nasync function handleLoadMore(event) {\n    refs.loadMore.classList.add('is-hidden')\n    refs.loader.classList.remove('hidden');\n    params.page += 1;\n\n    try {\n        const nextPages = await getImageBySearch(params)\n        createGallery(nextPages.hits) \n    }\n\n    catch (error) {\n    iziToast.error({\n      message: `An error has occurred:: ${error}`,\n      position: 'topRight',\n      timeout: 2000,\n    });\n    }\n    \n    finally {\n    refs.loader.classList.add('hidden');\n    const galleryItemHeight = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: galleryItemHeight * 2,\n      left: 0,\n      behavior: \"smooth\",\n    });\n\n    if (params.page === params.totalPages) {\n      refs.loadMore.classList.add('is-hidden');\n      iziToast.info({\n        message: 'We`re sorry, but you`ve reached the end of search results.',\n        position: 'topRight',\n        timeout: 2000,\n        icon: '',\n      });\n        refs.loadMore.removeEventListener('click', handleLoadMore);\n    } else {\n      refs.loadMore.classList.remove('is-hidden');\n    }\n  }\n}\n\n"],"names":["getImageBySearch","searchInput","page","perPage","axios","gallery","galleryContainer","SimpleLightbox","createGallery","data","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","refs","addImageBySearch","params","event","iziToast","totalResults","handleLoadMore","error","nextPages","galleryItemHeight"],"mappings":"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"}